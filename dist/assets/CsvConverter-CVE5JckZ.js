import{j as e}from"./components-BfCtsOZO.js";import{r as n,i as R,F as V,l as B,m as D,n as $,o as G}from"./icons-BrV6DUKz.js";import"./react-vendor-DavUf6mE.js";const H=({onBack:U})=>{const[o,O]=n.useState(""),[i,F]=n.useState(""),[f,v]=n.useState(!1),[y,d]=n.useState(""),[A,w]=n.useState(!1),[m,S]=n.useState(null),E=s=>{const l=s.target.files?.[0];if(l&&l.type==="text/csv"){const a=new FileReader;a.onload=g=>{const u=g.target?.result;O(u),d(""),w(!1),S(null)},a.readAsText(l)}else d("Please select a valid CSV file")},x=s=>{if(!s||s.trim()==="")return;if(s.startsWith("$")){const a=parseFloat(s.replace("$","").replace(",",""));return isNaN(a)?0:a}if(s.toUpperCase()==="TRUE")return!0;if(s.toUpperCase()==="FALSE")return!1;const l=parseFloat(s);return!isNaN(l)&&s.match(/^\d+\.?\d*$/)?l:s.trim()},J=()=>{if(!o.trim()){d("Please upload a CSV file first");return}v(!0),d("");try{const s=o.trim().split(`
`),l=s[0].split(","),a=s.slice(1).map((c,T)=>{const N=[];let p="",j=!1;for(let h=0;h<c.length;h++){const b=c[h];b==='"'?j=!j:b===","&&!j?(N.push(p),p=""):p+=b}N.push(p);const t={id:`comic-${T+1}`,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};return l.forEach((h,b)=>{const r=N[b]?.replace(/^"|"$/g,"");switch(h.trim()){case"title":t.title=r||"";break;case"seriesName":t.seriesName=r||"";break;case"issueNumber":t.issueNumber=parseInt(r)||1;break;case"releaseDate":t.releaseDate=r||new Date().toISOString().split("T")[0];break;case"coverImageUrl":t.coverImageUrl=r||"";break;case"coverArtist":t.coverArtist=r||"";break;case"grade":t.grade=parseFloat(r)||9;break;case"purchasePrice":const C=x(r);t.purchasePrice=typeof C=="number"?C:0;break;case"purchaseDate":t.purchaseDate=r||new Date().toISOString().split("T")[0];break;case"currentValue":const k=x(r);t.currentValue=typeof k=="number"?k:void 0;break;case"notes":t.notes=r||"";break;case"signedBy":t.signedBy=r||"";break;case"storageLocation":t.storageLocation=r||"";break;case"tags":t.tags=r?r.split(",").map(z=>z.trim()).filter(Boolean):[];break;case"isVariant":t.isVariant=x(r)===!0;break;case"isGraphicNovel":t.isGraphicNovel=x(r)===!0;break;case"isSlabbed":t.isSlabbed=x(r)===!0;break}}),t}),g=a.length,u=a.filter(c=>c.isVariant).length,L=a.filter(c=>c.isSlabbed).length,P=a.filter(c=>c.isGraphicNovel).length;S({totalComics:g,variants:u,slabbed:L,graphicNovels:P}),F(JSON.stringify(a,null,2)),w(!0)}catch(s){d(`Error converting CSV: ${s instanceof Error?s.message:"Unknown error"}`)}finally{v(!1)}},I=()=>{if(!i)return;const s=new Blob([i],{type:"application/json"}),l=URL.createObjectURL(s),a=document.createElement("a");a.href=l,a.download="comics.json",document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(l)};return e.jsxs("div",{className:"min-h-screen bg-gray-900",children:[e.jsx("div",{className:"bg-gray-800 shadow-lg border-b border-gray-700",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex items-center justify-between h-16",children:[e.jsxs("button",{onClick:U,className:"flex items-center space-x-2 text-gray-300 hover:text-white transition-colors",children:[e.jsx(R,{size:20}),e.jsx("span",{children:"Back to Collection"})]}),e.jsx("h1",{className:"text-xl font-bold text-white",children:"CSV to JSON Converter"})]})})}),e.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-lg border border-gray-700 p-6",children:[e.jsxs("h2",{className:"text-lg font-semibold text-white mb-4 flex items-center",children:[e.jsx(V,{size:20,className:"mr-2 text-blue-400"}),"CSV to JSON Converter"]}),e.jsx("p",{className:"text-gray-300 mb-4",children:"Upload your comics.banast.as.csv file to convert it to the JSON format required by the comic collection app."}),e.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-4",children:[e.jsx("h3",{className:"text-blue-300 font-medium mb-2",children:"Expected CSV Format:"}),e.jsx("p",{className:"text-blue-200 text-sm",children:"The CSV should contain columns: id, title, seriesName, issueNumber, releaseDate, coverImageUrl, coverArtist, grade, purchasePrice, purchaseDate, currentValue, notes, signedBy, storageLocation, tags, isVariant, isGraphicNovel, isSlabbed, createdAt, updatedAt"})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-lg border border-gray-700 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Step 1: Upload CSV File"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-600 rounded-lg p-8 text-center hover:border-blue-500 transition-colors",children:[e.jsx(B,{size:48,className:"mx-auto text-gray-500 mb-4"}),e.jsxs("label",{className:"cursor-pointer",children:[e.jsx("span",{className:"text-blue-400 hover:text-blue-300 font-medium",children:"Click to upload CSV file"}),e.jsx("input",{type:"file",accept:".csv",onChange:E,className:"hidden"})]}),e.jsx("p",{className:"text-gray-400 text-sm mt-2",children:"Select your comics.banast.as.csv file"})]}),o&&e.jsxs("div",{className:"mt-4 p-4 bg-green-500/10 border border-green-500/30 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(D,{size:16,className:"text-green-400"}),e.jsx("span",{className:"text-green-300 font-medium",children:"CSV file loaded successfully"})]}),e.jsxs("p",{className:"text-green-200 text-sm mt-1",children:[o.split(`
`).length-1," rows detected"]})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-lg border border-gray-700 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Step 2: Convert to JSON"}),e.jsx("button",{onClick:J,disabled:!o||f,className:"w-full flex items-center justify-center space-x-2 px-6 py-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:f?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Converting..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(V,{size:20}),e.jsx("span",{children:"Convert CSV to JSON"})]})}),y&&e.jsxs("div",{className:"mt-4 p-4 bg-red-500/10 border border-red-500/30 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx($,{size:16,className:"text-red-400"}),e.jsx("span",{className:"text-red-300 font-medium",children:"Error"})]}),e.jsx("p",{className:"text-red-200 text-sm mt-1",children:y})]}),A&&m&&e.jsxs("div",{className:"mt-4 p-4 bg-green-500/10 border border-green-500/30 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsx(D,{size:16,className:"text-green-400"}),e.jsx("span",{className:"text-green-300 font-medium",children:"Conversion successful!"})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-white font-bold text-lg",children:m.totalComics}),e.jsx("p",{className:"text-gray-400",children:"Total Comics"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-white font-bold text-lg",children:m.variants}),e.jsx("p",{className:"text-gray-400",children:"Variants"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-white font-bold text-lg",children:m.slabbed}),e.jsx("p",{className:"text-gray-400",children:"Slabbed"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-white font-bold text-lg",children:m.graphicNovels}),e.jsx("p",{className:"text-gray-400",children:"Graphic Novels"})]})]})]})]}),i&&e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-lg border border-gray-700 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Step 3: Download JSON"}),e.jsxs("button",{onClick:I,className:"w-full flex items-center justify-center space-x-2 px-6 py-3 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors",children:[e.jsx(G,{size:20}),e.jsx("span",{children:"Download comics.json"})]}),e.jsxs("div",{className:"mt-4 p-4 bg-gray-700/50 rounded-lg",children:[e.jsx("h4",{className:"text-white font-medium mb-2",children:"Next Steps:"}),e.jsxs("ol",{className:"text-gray-300 text-sm space-y-1 list-decimal list-inside",children:[e.jsx("li",{children:"Download the comics.json file using the button above"}),e.jsx("li",{children:"Replace the existing src/data/comics.json file with your new file"}),e.jsx("li",{children:"The app will automatically reload with your comic collection"})]})]})]}),i&&e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-lg border border-gray-700 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"JSON Preview"}),e.jsx("div",{className:"bg-gray-900 rounded-lg p-4 max-h-96 overflow-y-auto",children:e.jsxs("pre",{className:"text-gray-300 text-xs whitespace-pre-wrap break-words",children:[i.substring(0,2e3),i.length>2e3&&`
... (truncated for display)`]})})]})]})})]})};export{H as CsvConverter};
