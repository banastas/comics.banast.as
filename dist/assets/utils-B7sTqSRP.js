import{r as l}from"./icons-Bf2zPGvD.js";import{i as f}from"./data-OixKtRaR.js";const F={searchTerm:"",seriesName:"",minGrade:.5,maxGrade:10,minPrice:0,maxPrice:1e4,isSlabbed:null,isSigned:null,tags:[]},k=()=>{const[s,d]=l.useState([]),[h,V]=l.useState([]),[i,S]=l.useState(F),[u,P]=l.useState("releaseDate"),[m,b]=l.useState("desc"),[w,y]=l.useState(!0);l.useEffect(()=>{try{const e=Array.isArray(f)?f:f.comics||[];d(e)}catch(e){console.error("Error loading comics:",e),d([])}finally{y(!1)}},[]);const L=l.useCallback(e=>{const r={...e,id:crypto.randomUUID(),createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()},t=[...s,r];d(t)},[s]),D=l.useCallback((e,r)=>{const t=s.map(a=>a.id===e?{...a,...r,updatedAt:new Date().toISOString()}:a);d(t)},[s]),G=l.useCallback(e=>{const r=s.filter(t=>t.id!==e);d(r)},[s]);l.useEffect(()=>{let e=[...s];if(i.searchTerm){const r=i.searchTerm.toLowerCase();e=e.filter(t=>t.title.toLowerCase().includes(r)||t.seriesName.toLowerCase().includes(r)||(t.notes||"").toLowerCase().includes(r)||(t.signedBy||"").toLowerCase().includes(r)||t.coverArtist.toLowerCase().includes(r))}i.seriesName&&(e=e.filter(r=>r.seriesName.toLowerCase().includes(i.seriesName.toLowerCase()))),e=e.filter(r=>r.grade>=i.minGrade&&r.grade<=i.maxGrade),e=e.filter(r=>r.purchasePrice>=i.minPrice&&r.purchasePrice<=i.maxPrice),i.isSlabbed!==null&&(e=e.filter(r=>r.isSlabbed===i.isSlabbed)),i.isSigned!==null&&(e=e.filter(r=>i.isSigned?(r.signedBy||"").trim()!=="":(r.signedBy||"").trim()==="")),i.tags.length>0&&(e=e.filter(r=>i.tags.some(t=>(r.tags||[]).includes(t)))),e.sort((r,t)=>{let a,o;u==="currentValue"?(a=r.currentValue||r.purchasePrice,o=t.currentValue||t.purchasePrice):(a=r[u],o=t[u]);let n=0;return u==="title"?(n=r.title.localeCompare(t.title),n===0&&(n=r.issueNumber-t.issueNumber)):typeof a=="string"&&typeof o=="string"?n=a.localeCompare(o):typeof a=="number"&&typeof o=="number"&&(n=a-o),m==="asc"?n:-n}),V(e)},[s,i,u,m]);const c=s.filter(e=>e.currentValue!==void 0),p=s.reduce((e,r)=>e+r.purchasePrice,0),C=c.reduce((e,r)=>e+(r.currentValue||0),0),g=C-c.reduce((e,r)=>e+r.purchasePrice,0),N=c.length>0?g/c.reduce((e,r)=>e+r.purchasePrice,0)*100:0,x=c.reduce((e,r)=>{const t=(r.currentValue||0)-r.purchasePrice,a=e?(e.currentValue||0)-e.purchasePrice:-1/0;return t>a?r:e},null),A=c.reduce((e,r)=>{const t=(r.currentValue||0)-r.purchasePrice,a=e?(e.currentValue||0)-e.purchasePrice:1/0;return t<a?r:e},null),I={totalComics:s.length,totalValue:p,totalPurchaseValue:p,totalCurrentValue:C,highestValuedComic:s.reduce((e,r)=>!e||r.purchasePrice>e.purchasePrice?r:e,null),highestValuedSlabbedComic:s.filter(e=>e.isSlabbed).reduce((e,r)=>{const t=r.currentValue||r.purchasePrice,a=e?e.currentValue||e.purchasePrice:0;return t>a?r:e},null),highestValuedRawComic:s.filter(e=>!e.isSlabbed).reduce((e,r)=>{const t=r.currentValue||r.purchasePrice,a=e?e.currentValue||e.purchasePrice:0;return t>a?r:e},null),biggestGainer:x,biggestLoser:A,rawComics:s.filter(e=>!e.isSlabbed).length,slabbedComics:s.filter(e=>e.isSlabbed).length,signedComics:s.filter(e=>(e.signedBy||"").trim()!=="").length,averageGrade:s.length>0?s.reduce((e,r)=>e+r.grade,0)/s.length:0,totalGainLoss:g,totalGainLossPercentage:N,comicsWithCurrentValue:c.length};return{comics:h,allComics:s,stats:I,filters:i,sortField:u,sortDirection:m,loading:w,addComic:L,updateComic:D,deleteComic:G,setFilters:S,setSortField:P,setSortDirection:b}};export{k as u};
