import{j as e}from"./components-Bqs5Wn09.js";import{r as n,i as z,F as V,l as B,m as D,n as G,o as $}from"./icons-Bf2zPGvD.js";import"./react-vendor-D3F3s8fL.js";const H=({onBack:U})=>{const[o,O]=n.useState(""),[c,A]=n.useState(""),[f,v]=n.useState(!1),[y,d]=n.useState(""),[F,w]=n.useState(!1),[m,S]=n.useState(null),E=t=>{const l=t.target.files?.[0];if(l&&l.type==="text/csv"){const a=new FileReader;a.onload=p=>{const u=p.target?.result;O(u),d(""),w(!1),S(null)},a.readAsText(l)}else d("Please select a valid CSV file")},x=t=>{if(!t||t.trim()==="")return;if(t.startsWith("$")){const a=parseFloat(t.replace("$","").replace(",",""));return isNaN(a)?0:a}if(t.toUpperCase()==="TRUE")return!0;if(t.toUpperCase()==="FALSE")return!1;const l=parseFloat(t);return!isNaN(l)&&t.match(/^\d+\.?\d*$/)?l:t.trim()},I=()=>{if(!o.trim()){d("Please upload a CSV file first");return}v(!0),d("");try{const t=o.trim().split(`
`),l=t[0].split(","),a=t.slice(1).map((i,R)=>{const N=[];let b="",j=!1;for(let h=0;h<i.length;h++){const g=i[h];g==='"'?j=!j:g===","&&!j?(N.push(b),b=""):b+=g}N.push(b);const s={id:`comic-${R+1}`,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};return l.forEach((h,g)=>{const r=N[g]?.replace(/^"|"$/g,"");switch(h.trim()){case"title":s.title=r||"";break;case"seriesName":s.seriesName=r||"";break;case"issueNumber":s.issueNumber=parseInt(r)||1;break;case"releaseDate":s.releaseDate=r||new Date().toISOString().split("T")[0];break;case"coverImageUrl":s.coverImageUrl=r||"";break;case"coverArtist":s.coverArtist=r||"";break;case"grade":s.grade=parseFloat(r)||9;break;case"purchasePrice":const C=x(r);s.purchasePrice=typeof C=="number"?C:0;break;case"purchaseDate":s.purchaseDate=r||new Date().toISOString().split("T")[0];break;case"currentValue":const k=x(r);s.currentValue=typeof k=="number"?k:void 0;break;case"notes":s.notes=r||"";break;case"signedBy":s.signedBy=r||"";break;case"storageLocation":s.storageLocation=r||"";break;case"tags":s.tags=r?r.split(",").map(T=>T.trim()).filter(Boolean):[];break;case"isVariant":s.isVariant=x(r)===!0;break;case"isGraphicNovel":s.isGraphicNovel=x(r)===!0;break;case"isSlabbed":s.isSlabbed=x(r)===!0;break}}),!s.title&&s.seriesName&&(s.title=s.seriesName),s.title=s.title||s.seriesName||"Unknown Title",s.seriesName=s.seriesName||s.title||"Unknown Series",s.coverArtist=s.coverArtist||"",s.notes=s.notes||"",s.signedBy=s.signedBy||"",s.storageLocation=s.storageLocation||"",s.tags=s.tags||[],s.isVariant=s.isVariant||!1,s.isGraphicNovel=s.isGraphicNovel||!1,s.isSlabbed=s.isSlabbed||!1,s}),p=a.length,u=a.filter(i=>i.isVariant).length,L=a.filter(i=>i.isSlabbed).length,P=a.filter(i=>i.isGraphicNovel).length;S({totalComics:p,variants:u,slabbed:L,graphicNovels:P}),A(JSON.stringify(a,null,2)),w(!0)}catch(t){d(`Error converting CSV: ${t instanceof Error?t.message:"Unknown error"}`)}finally{v(!1)}},J=()=>{if(!c)return;const t=new Blob([c],{type:"application/json"}),l=URL.createObjectURL(t),a=document.createElement("a");a.href=l,a.download="comics.json",document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(l)};return e.jsxs("div",{className:"min-h-screen bg-gray-900",children:[e.jsx("div",{className:"bg-gray-800 shadow-lg border-b border-gray-700",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex items-center justify-between h-16",children:[e.jsxs("button",{onClick:U,className:"flex items-center space-x-2 text-gray-300 hover:text-white transition-colors",children:[e.jsx(z,{size:20}),e.jsx("span",{children:"Back to Collection"})]}),e.jsx("h1",{className:"text-xl font-bold text-white",children:"CSV to JSON Converter"})]})})}),e.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-lg border border-gray-700 p-6",children:[e.jsxs("h2",{className:"text-lg font-semibold text-white mb-4 flex items-center",children:[e.jsx(V,{size:20,className:"mr-2 text-blue-400"}),"CSV to JSON Converter"]}),e.jsx("p",{className:"text-gray-300 mb-4",children:"Upload your comics.banast.as.csv file to convert it to the JSON format required by the comic collection app."}),e.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/30 rounded-lg p-4",children:[e.jsx("h3",{className:"text-blue-300 font-medium mb-2",children:"Expected CSV Format:"}),e.jsxs("p",{className:"text-blue-200 text-sm",children:[e.jsx("strong",{children:"Required columns:"})," seriesName, issueNumber, releaseDate, grade, purchasePrice, purchaseDate",e.jsx("br",{}),e.jsx("strong",{children:"Optional columns:"})," title, coverImageUrl, coverArtist, currentValue, notes, signedBy, storageLocation, tags, isVariant, isGraphicNovel, isSlabbed",e.jsx("br",{}),e.jsx("strong",{children:"Note:"})," ID, createdAt, and updatedAt are auto-generated. If title is missing, seriesName will be used."]})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-lg border border-gray-700 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Step 1: Upload CSV File"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-600 rounded-lg p-8 text-center hover:border-blue-500 transition-colors",children:[e.jsx(B,{size:48,className:"mx-auto text-gray-500 mb-4"}),e.jsxs("label",{className:"cursor-pointer",children:[e.jsx("span",{className:"text-blue-400 hover:text-blue-300 font-medium",children:"Click to upload CSV file"}),e.jsx("input",{type:"file",accept:".csv",onChange:E,className:"hidden"})]}),e.jsx("p",{className:"text-gray-400 text-sm mt-2",children:"Select your comics.banast.as.csv file"})]}),o&&e.jsxs("div",{className:"mt-4 p-4 bg-green-500/10 border border-green-500/30 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(D,{size:16,className:"text-green-400"}),e.jsx("span",{className:"text-green-300 font-medium",children:"CSV file loaded successfully"})]}),e.jsxs("p",{className:"text-green-200 text-sm mt-1",children:[o.split(`
`).length-1," rows detected"]})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-lg border border-gray-700 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Step 2: Convert to JSON"}),e.jsx("button",{onClick:I,disabled:!o||f,className:"w-full flex items-center justify-center space-x-2 px-6 py-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:f?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Converting..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(V,{size:20}),e.jsx("span",{children:"Convert CSV to JSON"})]})}),y&&e.jsxs("div",{className:"mt-4 p-4 bg-red-500/10 border border-red-500/30 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(G,{size:16,className:"text-red-400"}),e.jsx("span",{className:"text-red-300 font-medium",children:"Error"})]}),e.jsx("p",{className:"text-red-200 text-sm mt-1",children:y})]}),F&&m&&e.jsxs("div",{className:"mt-4 p-4 bg-green-500/10 border border-green-500/30 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsx(D,{size:16,className:"text-green-400"}),e.jsx("span",{className:"text-green-300 font-medium",children:"Conversion successful!"})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-white font-bold text-lg",children:m.totalComics}),e.jsx("p",{className:"text-gray-400",children:"Total Comics"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-white font-bold text-lg",children:m.variants}),e.jsx("p",{className:"text-gray-400",children:"Variants"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-white font-bold text-lg",children:m.slabbed}),e.jsx("p",{className:"text-gray-400",children:"Slabbed"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-white font-bold text-lg",children:m.graphicNovels}),e.jsx("p",{className:"text-gray-400",children:"Graphic Novels"})]})]})]})]}),c&&e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-lg border border-gray-700 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Step 3: Download JSON"}),e.jsxs("button",{onClick:J,className:"w-full flex items-center justify-center space-x-2 px-6 py-3 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors",children:[e.jsx($,{size:20}),e.jsx("span",{children:"Download comics.json"})]}),e.jsxs("div",{className:"mt-4 p-4 bg-gray-700/50 rounded-lg",children:[e.jsx("h4",{className:"text-white font-medium mb-2",children:"Next Steps:"}),e.jsxs("ol",{className:"text-gray-300 text-sm space-y-1 list-decimal list-inside",children:[e.jsx("li",{children:"Download the comics.json file using the button above"}),e.jsx("li",{children:"Replace the existing src/data/comics.json file with your new file"}),e.jsx("li",{children:"The app will automatically reload with your comic collection"})]})]})]}),c&&e.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-lg border border-gray-700 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"JSON Preview"}),e.jsx("div",{className:"bg-gray-900 rounded-lg p-4 max-h-96 overflow-y-auto",children:e.jsxs("pre",{className:"text-gray-300 text-xs whitespace-pre-wrap break-words",children:[c.substring(0,2e3),c.length>2e3&&`
... (truncated for display)`]})})]})]})})]})};export{H as CsvConverter};
