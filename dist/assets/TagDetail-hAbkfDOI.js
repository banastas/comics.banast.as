import{j as s,D as $}from"./components-BQdbmStv.js";import{r as o,i as z,G,L as I,k as L,b as y,S as w}from"./icons-Bf2zPGvD.js";import"./react-vendor-D3F3s8fL.js";const A=({tag:i,tagComics:t,onBack:V,onView:u,onViewSeries:P,onViewTag:h})=>{const[x,p]=o.useState("grid"),[m,S]=o.useState("series");o.useEffect(()=>{window.scrollTo(0,0)},[]);const d=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(e),n=t.filter(e=>e.currentValue!==void 0),g=t.reduce((e,r)=>e+r.purchasePrice,0),b=n.reduce((e,r)=>e+(r.currentValue||0),0),j=b-n.reduce((e,r)=>e+r.purchasePrice,0),D=n.reduce((e,r)=>{const a=(r.currentValue||0)-r.purchasePrice,l=e?(e.currentValue||0)-e.purchasePrice:-1/0;return a>l?r:e},null),C=n.reduce((e,r)=>{const a=(r.currentValue||0)-r.purchasePrice,l=e?(e.currentValue||0)-e.purchasePrice:1/0;return a<l?r:e},null),k={totalComics:t.length,totalValue:g,totalPurchaseValue:g,totalCurrentValue:b,highestValuedComic:t.reduce((e,r)=>{const a=r.currentValue||r.purchasePrice,l=e?e.currentValue||e.purchasePrice:0;return a>l?r:e},null),highestValuedSlabbedComic:t.filter(e=>e.isSlabbed).reduce((e,r)=>{const a=r.currentValue||r.purchasePrice,l=e?e.currentValue||e.purchasePrice:0;return a>l?r:e},null),highestValuedRawComic:t.filter(e=>!e.isSlabbed).reduce((e,r)=>{const a=r.currentValue||r.purchasePrice,l=e?e.currentValue||e.purchasePrice:0;return a>l?r:e},null),biggestGainer:D,biggestLoser:C,rawComics:t.filter(e=>!e.isSlabbed).length,slabbedComics:t.filter(e=>e.isSlabbed).length,signedComics:t.filter(e=>e.signedBy.trim()!=="").length,averageGrade:t.length>0?t.reduce((e,r)=>e+r.grade,0)/t.length:0,totalGainLoss:j,totalGainLossPercentage:n.length>0&&n.reduce((e,r)=>e+r.purchasePrice,0)>0?j/n.reduce((e,r)=>e+r.purchasePrice,0)*100:0,comicsWithCurrentValue:n.length},c=Array.from(new Set(t.map(e=>e.seriesName))).sort(),N=Array.from(new Set(t.flatMap(e=>e.tags.filter(r=>r!==i)))).sort(),f=[...t].sort((e,r)=>{switch(m){case"series":{const a=e.seriesName.localeCompare(r.seriesName);return a!==0?a:e.issueNumber-r.issueNumber}case"issue":return e.issueNumber-r.issueNumber;case"grade":return r.grade-e.grade;case"value":{const a=e.currentValue||e.purchasePrice;return(r.currentValue||r.purchasePrice)-a}case"date":return new Date(r.releaseDate).getTime()-new Date(e.releaseDate).getTime();default:return e.seriesName.localeCompare(r.seriesName)}});return s.jsxs("div",{className:"min-h-screen bg-gray-900",children:[s.jsx("div",{className:"bg-gray-800 shadow-lg border-b border-gray-700",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:s.jsxs("div",{className:"flex items-center justify-between h-16",children:[s.jsxs("button",{onClick:V,className:"flex items-center space-x-2 text-gray-300 hover:text-white transition-colors",children:[s.jsx(z,{size:20}),s.jsx("span",{children:"Back to Collection"})]}),s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs("div",{className:"flex items-center space-x-2 border border-gray-600 rounded-lg",children:[s.jsx("button",{onClick:()=>p("grid"),className:`p-2 rounded-l-lg transition-colors ${x==="grid"?"bg-blue-500 text-white":"text-gray-300 hover:text-white"}`,children:s.jsx(G,{size:16})}),s.jsx("button",{onClick:()=>p("list"),className:`p-2 rounded-r-lg transition-colors ${x==="list"?"bg-blue-500 text-white":"text-gray-300 hover:text-white"}`,children:s.jsx(I,{size:16})})]}),s.jsxs("select",{value:m,onChange:e=>S(e.target.value),className:"bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-sm text-white",children:[s.jsx("option",{value:"series",children:"Sort by Series"}),s.jsx("option",{value:"issue",children:"Sort by Issue #"}),s.jsx("option",{value:"grade",children:"Sort by Grade"}),s.jsx("option",{value:"value",children:"Sort by Value"}),s.jsx("option",{value:"date",children:"Sort by Release Date"})]})]})]})})}),s.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:s.jsxs("div",{className:"space-y-8",children:[s.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-lg border border-gray-700 p-6",children:[s.jsx("div",{className:"flex items-center justify-between mb-6",children:s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx("div",{className:"p-3 bg-blue-500 rounded-lg",children:s.jsx(L,{size:24,className:"text-white"})}),s.jsxs("div",{children:[s.jsxs("h1",{className:"text-3xl font-bold text-white mb-2",children:["#",i]}),s.jsxs("p",{className:"text-gray-300",children:[t.length," comic",t.length!==1?"s":""," with this tag",c.length>0&&s.jsxs("span",{className:"text-gray-400 ml-2",children:["â€¢ ",c.length," series"]})]})]})]})}),s.jsx($,{stats:k,showDetailed:!0,onViewComic:u}),s.jsxs("div",{className:"mt-6 grid grid-cols-1 lg:grid-cols-2 gap-6",children:[c.length>0&&s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-semibold text-white mb-3",children:["Series with #",i]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:c.slice(0,8).map(e=>{const r=t.filter(l=>l.seriesName===e).length,a=t.filter(l=>l.seriesName===e).reduce((l,v)=>l+(v.currentValue||v.purchasePrice),0);return s.jsxs("div",{className:"bg-gray-700/30 rounded-lg p-3 border border-gray-600 cursor-pointer hover:border-blue-500 transition-colors",onClick:()=>P?.(e),children:[s.jsx("p",{className:"font-medium text-white text-sm truncate",children:e}),s.jsxs("p",{className:"text-xs text-gray-400",children:[r," issue",r!==1?"s":""]}),s.jsx("p",{className:"text-xs text-green-400",children:d(a)})]},e)})})]}),N.length>0&&s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-semibold text-white mb-3",children:"Related Tags"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:N.slice(0,12).map(e=>{const r=t.filter(a=>a.tags.includes(e)).length;return s.jsxs("button",{onClick:()=>h?.(e),className:"px-3 py-1 bg-gray-700/50 text-gray-300 text-sm rounded border border-gray-600 hover:border-blue-500 hover:text-blue-400 transition-colors",children:["#",e," (",r,")"]},e)})})]})]})]}),s.jsxs("div",{className:"bg-gray-800 rounded-lg shadow-lg border border-gray-700 p-6",children:[s.jsxs("h3",{className:"text-lg font-semibold text-white mb-4",children:["Comics tagged with #",i]}),x==="grid"?s.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4",children:f.map(e=>s.jsxs("div",{className:"bg-gray-700/50 rounded-lg border border-gray-600 overflow-hidden hover:border-blue-500 transition-all cursor-pointer group",onClick:()=>u(e),children:[s.jsxs("div",{className:"relative aspect-[2/3] bg-gray-600",children:[e.coverImageUrl?s.jsx("img",{src:e.coverImageUrl,alt:`${e.seriesName} #${e.issueNumber}`,className:"w-full h-full object-cover group-hover:scale-105 transition-transform"}):s.jsx("div",{className:"w-full h-full flex items-center justify-center",children:s.jsx(y,{size:32,className:"text-gray-500"})}),s.jsxs("div",{className:"absolute top-1 left-1 flex flex-col space-y-1",children:[e.isSlabbed&&s.jsx("span",{className:"px-1 py-0.5 bg-purple-500 text-white text-xs font-medium rounded",children:"Slab"}),e.signedBy&&s.jsx("span",{className:"px-1 py-0.5 bg-rose-500 text-white text-xs font-medium rounded",children:"Signed"})]})]}),s.jsxs("div",{className:"p-3",children:[s.jsx("p",{className:"font-medium text-white text-sm truncate mb-1",children:e.seriesName}),s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsxs("p",{className:"text-xs text-gray-400",children:["#",e.issueNumber]}),s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx(w,{size:10,className:"text-amber-400"}),s.jsx("span",{className:"text-xs text-white",children:e.grade})]})]}),s.jsx("p",{className:"text-xs text-gray-400 mb-1",children:new Date(e.releaseDate).getFullYear()}),s.jsx("p",{className:"text-xs font-semibold text-green-400",children:d(e.currentValue||e.purchasePrice)})]})]},e.id))}):s.jsx("div",{className:"space-y-2",children:f.map(e=>s.jsx("div",{className:"bg-gray-700/50 rounded-lg border border-gray-600 p-4 hover:border-blue-500 transition-all cursor-pointer group",onClick:()=>u(e),children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsx("div",{className:"w-12 h-16 bg-gray-600 rounded overflow-hidden flex-shrink-0",children:e.coverImageUrl?s.jsx("img",{src:e.coverImageUrl,alt:`${e.seriesName} #${e.issueNumber}`,className:"w-full h-full object-cover"}):s.jsx("div",{className:"w-full h-full flex items-center justify-center",children:s.jsx(y,{size:16,className:"text-gray-500"})})}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsxs("h4",{className:"font-bold text-white",children:[e.seriesName," #",e.issueNumber]}),s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx(w,{size:12,className:"text-amber-400"}),s.jsx("span",{className:"text-sm text-white",children:e.grade})]}),e.isSlabbed&&s.jsx("span",{className:"px-2 py-0.5 bg-purple-500/20 text-purple-300 text-xs rounded border border-purple-500/30",children:"Slabbed"}),e.signedBy&&s.jsx("span",{className:"px-2 py-0.5 bg-rose-500/20 text-rose-300 text-xs rounded border border-rose-500/30",children:"Signed"})]}),s.jsx("p",{className:"text-sm text-gray-300",children:e.title}),s.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:e.tags.map(r=>s.jsxs("span",{className:`px-2 py-0.5 text-xs rounded border cursor-pointer transition-colors ${r===i?"bg-blue-500/20 text-blue-300 border-blue-500/30":"bg-gray-600/20 text-gray-400 border-gray-600/30 hover:border-blue-500/30 hover:text-blue-400"}`,onClick:a=>{a.stopPropagation(),r!==i&&h?.(r)},children:["#",r]},r))})]})]}),s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"font-semibold text-white",children:d(e.currentValue||e.purchasePrice)}),e.currentValue&&e.currentValue!==e.purchasePrice&&s.jsxs("p",{className:`text-xs ${e.currentValue>e.purchasePrice?"text-emerald-400":"text-red-400"}`,children:[e.currentValue>e.purchasePrice?"+":"",d(e.currentValue-e.purchasePrice),e.purchasePrice>0&&` (${((e.currentValue-e.purchasePrice)/e.purchasePrice*100).toFixed(1)}%)`]})]}),s.jsx("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity",onClick:r=>r.stopPropagation()})]})]})},e.id))})]})]})})]})};export{A as TagDetail};
